<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Frida Cheatsheet | reHex Ninja</title>
<meta name="keywords" content="tools/binary-analysis, cheatsheet, frida" />
<meta name="description" content="Frida Cheatsheet - reHex Ninja">
<meta name="author" content="trib0r3">
<link rel="canonical" href="https://rehex.ninja/posts/frida-cheatsheet/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://rehex.ninja/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://rehex.ninja/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://rehex.ninja/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://rehex.ninja/apple-touch-icon.png">
<link rel="mask-icon" href="https://rehex.ninja/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.0" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Frida Cheatsheet" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rehex.ninja/posts/frida-cheatsheet/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-26T15:25:42&#43;02:00" />
<meta property="article:modified_time" content="2020-07-26T15:25:42&#43;02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Frida Cheatsheet"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://rehex.ninja/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Frida Cheatsheet",
      "item": "https://rehex.ninja/posts/frida-cheatsheet/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Frida Cheatsheet",
  "name": "Frida Cheatsheet",
  "description": "",
  "keywords": [
    "tools/binary-analysis", "cheatsheet", "frida"
  ],
  "articleBody": " Notes are mostly based on the frida-boot labs.\n Quick Start Frida project quick start:\ngit clone https://github.com/trib0r3/frida-scripts Default stuff  remote port: 27042  Code snippets:  GitHub - iddoeldor/frida-snippets: Hand-crafted Frida examples https://codeshare.frida.re/  Useful API calls Debugging // print local environment (variables) console.log(JSON.stringify(this.context, null, 4)) Enumerate binary // list loaded libraries Process.enumerateModulesSync(); // list functions of the library Process.getModuleByName(\"libc-2.30.so\").enumerateExports(); Resolving libs/funcs location // get reference to library Process.getModuleByName(\"libc-2.30.so\"); // Retrieve from symbols Module.getExportByName(/* libname or */ null, \"sleep\"); DebugSymbol.getFunctionByName(\"sleep\"); // Calculate based on offset Module.getBaseAddress(\"libc-2.30.so\").add(\"0xcad90\"); \"0x7fc2edc42d90\" Script Communication  via recv and send via RPC  you can provide arguments and receive the return values whole logic can be held in python, only binary operations are in JS    RPC  TypeScript  Get reference to the function Create it prototype Make them python-accessible by adding them to the rpc.exports dictionary.   Python  Reference functions with script.exports.()    var testPinPtr = DebugSymbol.getFunctionByName(\"test_pin\"); var testPin = new NativeFunction(testPinPtr, \"int\", [\"pointer\"]); rpc.exports = { // defince accessible funcs from python  testPin: function(p) { var pin = Memory.allocUtf8String(p); return testPin(pin); } } import frida import sys with open(\"index.js\", \"r\") as f: agent = f.read() session = frida.attach(\"crypt\") script = session.create_script(agent) script.load() api = script.exports # ref to funcs from js for x in range(0, 9999): res = api.test_pin(str(x)) if res == 0: continue print(f\"Pin: {x}\") break Reuse the binary code // get addr var testPinPtr = DebugSymbol.getFunctionByName(\"test_pin\"); // create JS wrapper var testPin = new NativeFunction(testPinPtr, \"int\", [\"pointer\"]); for (var i = 0; i  9999; i++) { console.log(\"Trying: \" + i.toString()); var pin = Memory.allocUtf8String(i.toString()); var r = testPin(pin); if (r == 1) { console.log(\"Pin is: \" + i.toString()); break; } } Function Hooking By symbol from __future__ import print_function import frida import sys session = frida.attach(\"hello\") script = session.create_script(\"\"\" Interceptor.attach(ptr(\"%s\"), { onEnter: function(args) { send(args[0].toInt32()); } }); \"\"\" % int(sys.argv[1], 16)) def on_message(message, data): print(message) script.on(‘message’, on_message) script.load() sys.stdin.read() By symbol var rand_range = DebugSymbol.getFunctionByName(\"rand_range\"); Interceptor.attach(rand_range, { onEnter: function(args) { // Replace with string  args[0] = Memory.allocUtf8String(\"Frida sleep! :D\\n\"); // Replace with int  args[0] = new NativePointer(\"0x1\") // or ptr(\"0x1\")  // Update the value  this.arg1 = args[0]; }, onLeave: function(retval) { console.log(retval); retval.replace(this.arg1); } }); Remote execution (debugging)  Proptip: Just add -H or -R if you want to use remote mode with default settings or you want to provide remote connection details\n  frida-server frida-gadget  Tools frida CLI Open binary with frida  command and play with it in interactive shell session.\nfrida-server (remote) # on victim frida-server -l 0.0.0.0:1337 # on local client frida-ps -H $IP:$PORT -R frida -H $IP:$PORT $proc_name frida-gadget (remote) Loaded apps are paused (can be changed), common ways of injecting gadget:\n load with LD_PRELOAD load with patchelf  # on victim LD_PRELOAD=./frida-gadget.so ./crypt # on analysis machine frida-ps -R # should yield gadget process frida -R Gadget # on victim $ patchelf --add-needed ../frida-gadget.so crypt # on analysis machine $ ./crypt [Frida INFO] Listening on 127.0.0.1 TCP port 27042 Configure with frida-gadget.config (default):\n{ \"interaction\": { \"type\": \"listen\", \"address\": \"127.0.0.1\", \"port\": 27042, \"on_load\": \"resume\" } } Scripting:\n{ \"interaction\": { \"type\": \"script\", \"path\": \"/root/code/embedded-agent.js\" } } var testPinPtr = DebugSymbol.getFunctionByName(\"test_pin\"); var testPin = new NativeFunction(testPinPtr, \"int\", [\"pointer\"]); for (var i = 0; i  9999; i++) { console.log(\"Trying: \" + i.toString()); var pin = Memory.allocUtf8String(i.toString()); var r = testPin(pin); if (r == 1) { console.log(\"Pin is: \" + i.toString()); break; } } frida-trace  Select function to trace Edit desired function behaviour  Open __hooks__ directory edit scripts there   Run \u0026 watch new injected behaviour  onEnter: function (log, args, state) { args[1] = ptr('1337'); log('printf(' + 'format=\"' + args[0].readUtf8String() + '\"' + ')'); }, Examples Spawn web server import { log } from \"./logger\"; import * as http from \"http\"; const testPinPtr = DebugSymbol.getFunctionByName(\"test_pin\"); const testPin = new NativeFunction(testPinPtr, \"int\", [\"pointer\"]); rpc.exports = { testPin: function(p: string) { const pin = Memory.allocUtf8String(p); return testPin(pin); }, httpServer: function() { http.createServer((req, res) = { const pin = req.url? req.url.replace('/', '') : ''; const check = this.testPin(pin); log(`Request to check ${req.url}returned ${check}`); if (check == 1) { res.writeHead(200, {'Content-Type': 'text/plain'}); res.write(`Welcome!\\n`); } else { res.writeHead(401, {'Content-Type': 'text/plain'}); res.write(`Wrong PIN\\n`); } res.end(); }).listen(1337); } } import frida import sys with open(\"frida-agent-example/_agent.js\", \"r\") as f: agent = f.read() session = frida.attach(\"crypt\") script = session.create_script(agent) script.load() api = script.exports print(\"starting HTTP server...\") api.http_server() # keep the server alive now sys.stdin.read() npm run build # or watch References  https://frida.re https://github.com/leonjza/frida-boot ",
  "wordCount" : "724",
  "inLanguage": "en",
  "datePublished": "2020-07-26T15:25:42+02:00",
  "dateModified": "2020-07-26T15:25:42+02:00",
  "author":{
    "@type": "Person",
    "name": "trib0r3"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rehex.ninja/posts/frida-cheatsheet/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "reHex Ninja",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rehex.ninja/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://rehex.ninja" accesskey="h" title="reHex Ninja (Alt + H)">reHex Ninja</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://rehex.ninja/tags" title="#tags">
                    <span>#tags</span>
                </a>
            </li>
            <li>
                <a href="https://rehex.ninja/search" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="https://rehex.ninja/archives" title="archives">
                    <span>archives</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://rehex.ninja">Home</a>&nbsp;»&nbsp;<a href="https://rehex.ninja/posts/">Posts</a></div>
    <h1 class="post-title">
      Frida Cheatsheet
    </h1>
    <div class="post-meta"><span title='2020-07-26 15:25:42 +0200 CEST'>July 26, 2020</span>&nbsp;·&nbsp;trib0r3&nbsp;|&nbsp;<a href="https://github.com/trib0r3/trib0r3.github.io/posts/frida-cheatsheet.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#quick-start" aria-label="Quick Start">Quick Start</a></li>
                <li>
                    <a href="#default-stuff" aria-label="Default stuff">Default stuff</a></li>
                <li>
                    <a href="#code-snippets" aria-label="Code snippets:">Code snippets:</a></li>
                <li>
                    <a href="#useful-api-calls" aria-label="Useful API calls">Useful API calls</a><ul>
                        
                <li>
                    <a href="#debugging" aria-label="Debugging">Debugging</a></li>
                <li>
                    <a href="#enumerate-binary" aria-label="Enumerate binary">Enumerate binary</a></li>
                <li>
                    <a href="#resolving-libsfuncs-location" aria-label="Resolving libs/funcs location">Resolving libs/funcs location</a></li></ul>
                </li>
                <li>
                    <a href="#script-communication" aria-label="Script Communication">Script Communication</a><ul>
                        
                <li>
                    <a href="#rpc" aria-label="RPC">RPC</a></li></ul>
                </li>
                <li>
                    <a href="#reuse-the-binary-code" aria-label="Reuse the binary code">Reuse the binary code</a></li>
                <li>
                    <a href="#function-hooking" aria-label="Function Hooking">Function Hooking</a><ul>
                        
                <li>
                    <a href="#by-symbol" aria-label="By symbol">By symbol</a></li>
                <li>
                    <a href="#by-symbol-1" aria-label="By symbol">By symbol</a></li></ul>
                </li>
                <li>
                    <a href="#remote-execution-debugging" aria-label="Remote execution (debugging)">Remote execution (debugging)</a></li>
                <li>
                    <a href="#tools" aria-label="Tools">Tools</a><ul>
                        
                <li>
                    <a href="#frida-cli" aria-label="frida CLI">frida CLI</a></li>
                <li>
                    <a href="#frida-server-remote" aria-label="frida-server (remote)">frida-server (remote)</a></li>
                <li>
                    <a href="#frida-gadget-remote" aria-label="frida-gadget (remote)">frida-gadget (remote)</a></li>
                <li>
                    <a href="#frida-trace" aria-label="frida-trace">frida-trace</a></li></ul>
                </li>
                <li>
                    <a href="#examples" aria-label="Examples">Examples</a><ul>
                        
                <li>
                    <a href="#spawn-web-server" aria-label="Spawn web server">Spawn web server</a></li></ul>
                </li>
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>Notes are mostly based on the <a href="#references">frida-boot</a> labs.</p>
</blockquote>
<h2 id="quick-start">Quick Start<a hidden class="anchor" aria-hidden="true" href="#quick-start">#</a></h2>
<p>Frida project quick start:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://github.com/trib0r3/frida-scripts
</code></pre></div><h2 id="default-stuff">Default stuff<a hidden class="anchor" aria-hidden="true" href="#default-stuff">#</a></h2>
<ul>
<li>remote port: <code>27042</code></li>
</ul>
<h2 id="code-snippets">Code snippets:<a hidden class="anchor" aria-hidden="true" href="#code-snippets">#</a></h2>
<ul>
<li><a href="https://github.com/iddoeldor/frida-snippets">GitHub - iddoeldor/frida-snippets: Hand-crafted Frida examples</a></li>
<li><a href="https://codeshare.frida.re/">https://codeshare.frida.re/</a></li>
</ul>
<h2 id="useful-api-calls">Useful API calls<a hidden class="anchor" aria-hidden="true" href="#useful-api-calls">#</a></h2>
<h3 id="debugging">Debugging<a hidden class="anchor" aria-hidden="true" href="#debugging">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#75715e">// print local environment (variables)
</span><span style="color:#75715e"></span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">context</span>, <span style="color:#66d9ef">null</span>, <span style="color:#ae81ff">4</span>))
</code></pre></div><h3 id="enumerate-binary">Enumerate binary<a hidden class="anchor" aria-hidden="true" href="#enumerate-binary">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#75715e">// list loaded libraries
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Process</span>.<span style="color:#a6e22e">enumerateModulesSync</span>();

<span style="color:#75715e">// list functions of the library
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Process</span>.<span style="color:#a6e22e">getModuleByName</span>(<span style="color:#e6db74">&#34;libc-2.30.so&#34;</span>).<span style="color:#a6e22e">enumerateExports</span>();
</code></pre></div><h3 id="resolving-libsfuncs-location">Resolving libs/funcs location<a hidden class="anchor" aria-hidden="true" href="#resolving-libsfuncs-location">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#75715e">// get reference to library
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Process</span>.<span style="color:#a6e22e">getModuleByName</span>(<span style="color:#e6db74">&#34;libc-2.30.so&#34;</span>);

<span style="color:#75715e">// Retrieve from symbols
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Module</span>.<span style="color:#a6e22e">getExportByName</span>(<span style="color:#75715e">/* libname or */</span> <span style="color:#66d9ef">null</span>, <span style="color:#e6db74">&#34;sleep&#34;</span>);
<span style="color:#a6e22e">DebugSymbol</span>.<span style="color:#a6e22e">getFunctionByName</span>(<span style="color:#e6db74">&#34;sleep&#34;</span>);

<span style="color:#75715e">// Calculate based on offset
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Module</span>.<span style="color:#a6e22e">getBaseAddress</span>(<span style="color:#e6db74">&#34;libc-2.30.so&#34;</span>).<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;0xcad90&#34;</span>);
<span style="color:#e6db74">&#34;0x7fc2edc42d90&#34;</span>
</code></pre></div><h2 id="script-communication">Script Communication<a hidden class="anchor" aria-hidden="true" href="#script-communication">#</a></h2>
<ol>
<li>via <code>recv</code> and <code>send</code></li>
<li>via RPC
<ul>
<li>you can provide arguments and receive the return values</li>
<li>whole logic can be held in python, only binary operations are in JS</li>
</ul>
</li>
</ol>
<h3 id="rpc">RPC<a hidden class="anchor" aria-hidden="true" href="#rpc">#</a></h3>
<ul>
<li>TypeScript
<ol>
<li>Get reference to the function</li>
<li>Create it prototype</li>
<li>Make them python-accessible by adding them to the <code>rpc.exports</code> dictionary.</li>
</ol>
</li>
<li>Python
<ol>
<li>Reference functions with <code>script.exports.&lt;func_name&gt;()</code></li>
</ol>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">testPinPtr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DebugSymbol</span>.<span style="color:#a6e22e">getFunctionByName</span>(<span style="color:#e6db74">&#34;test_pin&#34;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">testPin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">NativeFunction</span>(<span style="color:#a6e22e">testPinPtr</span>, <span style="color:#e6db74">&#34;int&#34;</span>, [<span style="color:#e6db74">&#34;pointer&#34;</span>]);

<span style="color:#a6e22e">rpc</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> { <span style="color:#75715e">// defince accessible funcs from python
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">testPin</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">p</span>) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Memory</span>.<span style="color:#a6e22e">allocUtf8String</span>(<span style="color:#a6e22e">p</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">testPin</span>(<span style="color:#a6e22e">pin</span>);
    }
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> frida
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;index.js&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> f:
    agent <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()

session <span style="color:#f92672">=</span> frida<span style="color:#f92672">.</span>attach(<span style="color:#e6db74">&#34;crypt&#34;</span>)
script <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>create_script(agent)
script<span style="color:#f92672">.</span>load()

api <span style="color:#f92672">=</span> script<span style="color:#f92672">.</span>exports <span style="color:#75715e"># ref to funcs from js</span>

<span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9999</span>):
    res <span style="color:#f92672">=</span> api<span style="color:#f92672">.</span>test_pin(str(x))
    <span style="color:#66d9ef">if</span> res <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">continue</span>

    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Pin: </span><span style="color:#e6db74">{</span>x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
    <span style="color:#66d9ef">break</span>

</code></pre></div><h2 id="reuse-the-binary-code">Reuse the binary code<a hidden class="anchor" aria-hidden="true" href="#reuse-the-binary-code">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">// get addr
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">testPinPtr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DebugSymbol</span>.<span style="color:#a6e22e">getFunctionByName</span>(<span style="color:#e6db74">&#34;test_pin&#34;</span>);

<span style="color:#75715e">// create JS wrapper
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">testPin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">NativeFunction</span>(<span style="color:#a6e22e">testPinPtr</span>, <span style="color:#e6db74">&#34;int&#34;</span>, [<span style="color:#e6db74">&#34;pointer&#34;</span>]);


<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9999</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Trying: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>());
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Memory</span>.<span style="color:#a6e22e">allocUtf8String</span>(<span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>());
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">testPin</span>(<span style="color:#a6e22e">pin</span>);

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Pin is: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>());
        <span style="color:#66d9ef">break</span>;
    }
}
</code></pre></div><h2 id="function-hooking">Function Hooking<a hidden class="anchor" aria-hidden="true" href="#function-hooking">#</a></h2>
<h3 id="by-symbol">By symbol<a hidden class="anchor" aria-hidden="true" href="#by-symbol">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> __future__ <span style="color:#f92672">import</span> print_function
<span style="color:#f92672">import</span> frida
<span style="color:#f92672">import</span> sys

session <span style="color:#f92672">=</span> frida<span style="color:#f92672">.</span>attach(<span style="color:#e6db74">&#34;hello&#34;</span>)
script <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>create_script(<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Interceptor.attach(ptr(&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;), {
</span><span style="color:#e6db74">    onEnter: function(args) {
</span><span style="color:#e6db74">        send(args[0].toInt32());
</span><span style="color:#e6db74">    }
</span><span style="color:#e6db74">});
</span><span style="color:#e6db74">&#34;&#34;&#34;</span> <span style="color:#f92672">%</span> int(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">16</span>))
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_message</span>(message, data):
    print(message)
script<span style="color:#f92672">.</span>on(<span style="color:#960050;background-color:#1e0010">‘</span>message<span style="color:#960050;background-color:#1e0010">’</span>, on_message)
script<span style="color:#f92672">.</span>load()
sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>read()
</code></pre></div><h3 id="by-symbol-1">By symbol<a hidden class="anchor" aria-hidden="true" href="#by-symbol-1">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">rand_range</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DebugSymbol</span>.<span style="color:#a6e22e">getFunctionByName</span>(<span style="color:#e6db74">&#34;rand_range&#34;</span>);

<span style="color:#a6e22e">Interceptor</span>.<span style="color:#a6e22e">attach</span>(<span style="color:#a6e22e">rand_range</span>, {
    <span style="color:#a6e22e">onEnter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">args</span>) {
        <span style="color:#75715e">// Replace with string
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">Memory</span>.<span style="color:#a6e22e">allocUtf8String</span>(<span style="color:#e6db74">&#34;Frida sleep! :D\n&#34;</span>);
        <span style="color:#75715e">// Replace with int
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">NativePointer</span>(<span style="color:#e6db74">&#34;0x1&#34;</span>) <span style="color:#75715e">// or ptr(&#34;0x1&#34;)
</span><span style="color:#75715e"></span>        
        <span style="color:#75715e">// Update the value
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">arg1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>];
    },
    <span style="color:#a6e22e">onLeave</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">retval</span>) {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">retval</span>);
        <span style="color:#a6e22e">retval</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">arg1</span>);
    }
});
</code></pre></div><h2 id="remote-execution-debugging">Remote execution (debugging)<a hidden class="anchor" aria-hidden="true" href="#remote-execution-debugging">#</a></h2>
<blockquote>
<p>Proptip: Just add <code>-H</code> or <code>-R</code> if you want to use remote mode with default settings or you want to provide remote connection details</p>
</blockquote>
<ul>
<li><a href="#frida-server-remote">frida-server</a></li>
<li><a href="#frida-gadget-remote">frida-gadget</a></li>
</ul>
<h2 id="tools">Tools<a hidden class="anchor" aria-hidden="true" href="#tools">#</a></h2>
<h3 id="frida-cli">frida CLI<a hidden class="anchor" aria-hidden="true" href="#frida-cli">#</a></h3>
<p>Open binary with <code>frida &lt;exec&gt;</code> command and play with it in interactive shell session.</p>
<h3 id="frida-server-remote">frida-server (remote)<a hidden class="anchor" aria-hidden="true" href="#frida-server-remote">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># on victim</span>
frida-server -l 0.0.0.0:1337

<span style="color:#75715e"># on local client</span>
frida-ps -H $IP:$PORT -R
frida -H $IP:$PORT $proc_name
</code></pre></div><h3 id="frida-gadget-remote">frida-gadget (remote)<a hidden class="anchor" aria-hidden="true" href="#frida-gadget-remote">#</a></h3>
<p>Loaded apps are <strong>paused</strong> (can be changed), common ways of injecting gadget:</p>
<ul>
<li>load with LD_PRELOAD</li>
<li>load with patchelf</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># on victim</span>
LD_PRELOAD<span style="color:#f92672">=</span>./frida-gadget.so ./crypt

<span style="color:#75715e"># on analysis machine</span>
frida-ps -R <span style="color:#75715e"># should yield gadget process</span>
frida -R Gadget
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># on victim</span>
$ patchelf --add-needed ../frida-gadget.so crypt

<span style="color:#75715e"># on analysis machine</span>
$ ./crypt
<span style="color:#f92672">[</span>Frida INFO<span style="color:#f92672">]</span> Listening on 127.0.0.1 TCP port <span style="color:#ae81ff">27042</span>
</code></pre></div><p>Configure with <code>frida-gadget.config</code> (default):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;interaction&#34;</span>: {
    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;listen&#34;</span>,
    <span style="color:#f92672">&#34;address&#34;</span>: <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,
    <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">27042</span>,
    <span style="color:#f92672">&#34;on_load&#34;</span>: <span style="color:#e6db74">&#34;resume&#34;</span>
  }
}
</code></pre></div><p>Scripting:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;interaction&#34;</span>: {
    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;script&#34;</span>,
    <span style="color:#f92672">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;/root/code/embedded-agent.js&#34;</span>
  }
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">testPinPtr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DebugSymbol</span>.<span style="color:#a6e22e">getFunctionByName</span>(<span style="color:#e6db74">&#34;test_pin&#34;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">testPin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">NativeFunction</span>(<span style="color:#a6e22e">testPinPtr</span>, <span style="color:#e6db74">&#34;int&#34;</span>, [<span style="color:#e6db74">&#34;pointer&#34;</span>]);

<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9999</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Trying: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>());
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Memory</span>.<span style="color:#a6e22e">allocUtf8String</span>(<span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>());
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">testPin</span>(<span style="color:#a6e22e">pin</span>);

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Pin is: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">toString</span>());
        <span style="color:#66d9ef">break</span>;
    }
}
</code></pre></div><h3 id="frida-trace">frida-trace<a hidden class="anchor" aria-hidden="true" href="#frida-trace">#</a></h3>
<ol>
<li>Select function to trace</li>
<li>Edit desired function behaviour
<ol>
<li>Open <code>__hooks__</code> directory</li>
<li>edit scripts there</li>
</ol>
</li>
<li>Run &amp; watch new injected behaviour</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">  <span style="color:#a6e22e">onEnter</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">log</span>, <span style="color:#a6e22e">args</span>, <span style="color:#a6e22e">state</span>) {
    <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">ptr</span>(<span style="color:#e6db74">&#39;1337&#39;</span>);
    <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;printf(&#39;</span> <span style="color:#f92672">+</span>
      <span style="color:#e6db74">&#39;format=&#34;&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">readUtf8String</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&#34;&#39;</span> <span style="color:#f92672">+</span>
    <span style="color:#e6db74">&#39;)&#39;</span>);
  },
</code></pre></div><h2 id="examples">Examples<a hidden class="anchor" aria-hidden="true" href="#examples">#</a></h2>
<h3 id="spawn-web-server">Spawn web server<a hidden class="anchor" aria-hidden="true" href="#spawn-web-server">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">log</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./logger&#34;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">as</span> <span style="color:#a6e22e">http</span> <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;http&#34;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">testPinPtr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DebugSymbol</span>.<span style="color:#a6e22e">getFunctionByName</span>(<span style="color:#e6db74">&#34;test_pin&#34;</span>);
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">testPin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">NativeFunction</span>(<span style="color:#a6e22e">testPinPtr</span>, <span style="color:#e6db74">&#34;int&#34;</span>, [<span style="color:#e6db74">&#34;pointer&#34;</span>]);

<span style="color:#a6e22e">rpc</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">testPin</span>: <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">p</span>: <span style="color:#66d9ef">string</span>) {
        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Memory</span>.<span style="color:#a6e22e">allocUtf8String</span>(<span style="color:#a6e22e">p</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">testPin</span>(<span style="color:#a6e22e">pin</span>);
    },
    <span style="color:#a6e22e">httpServer</span>: <span style="color:#66d9ef">function</span>() {
        <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">createServer</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) <span style="color:#f92672">=&gt;</span> {
            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">url</span><span style="color:#f92672">?</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>;
            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">check</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">testPin</span>(<span style="color:#a6e22e">pin</span>);

            <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Request to check </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> returned </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">check</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);

            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">check</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
                <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">writeHead</span>(<span style="color:#ae81ff">200</span>, {<span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;text/plain&#39;</span>});
                <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">write</span>(<span style="color:#e6db74">`Welcome!</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">n`</span>);
            } <span style="color:#66d9ef">else</span> {
                <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">writeHead</span>(<span style="color:#ae81ff">401</span>, {<span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;text/plain&#39;</span>});
                <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">write</span>(<span style="color:#e6db74">`Wrong PIN</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">n`</span>);
            }

            <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">end</span>();
        }).<span style="color:#a6e22e">listen</span>(<span style="color:#ae81ff">1337</span>);
    }
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> frida
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;frida-agent-example/_agent.js&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> f:
    agent <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()

session <span style="color:#f92672">=</span> frida<span style="color:#f92672">.</span>attach(<span style="color:#e6db74">&#34;crypt&#34;</span>)
script <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>create_script(agent)
script<span style="color:#f92672">.</span>load()

api <span style="color:#f92672">=</span> script<span style="color:#f92672">.</span>exports
print(<span style="color:#e6db74">&#34;starting HTTP server...&#34;</span>)
api<span style="color:#f92672">.</span>http_server()

<span style="color:#75715e"># keep the server alive now</span>
sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>read()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npm run build <span style="color:#75715e"># or watch</span>
</code></pre></div><h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ul>
<li><a href="https://frida.re">https://frida.re</a></li>
<li><a href="https://github.com/leonjza/frida-boot">https://github.com/leonjza/frida-boot</a></li>
</ul>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://rehex.ninja/tags/tools/binary-analysis/">tools/binary-analysis</a></li>
      <li><a href="https://rehex.ninja/tags/cheatsheet/">cheatsheet</a></li>
      <li><a href="https://rehex.ninja/tags/frida/">frida</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://rehex.ninja/posts/0-frida-playgrounds/">
    <span class="title">« Prev Page</span>
    <br>
    <span>[0x0] FRIDA Playground</span>
  </a>
  <a class="next" href="https://rehex.ninja/posts/nothing-is-lost-in-the-internet/">
    <span class="title">Next Page »</span>
    <br>
    <span>Nothing Is Lost in the Internet</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Frida Cheatsheet on twitter"
        href="https://twitter.com/intent/tweet/?text=Frida%20Cheatsheet&amp;url=https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f&amp;hashtags=tools%2fbinary-analysis%2ccheatsheet%2cfrida">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Frida Cheatsheet on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f&amp;title=Frida%20Cheatsheet&amp;summary=Frida%20Cheatsheet&amp;source=https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Frida Cheatsheet on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f&title=Frida%20Cheatsheet">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Frida Cheatsheet on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Frida Cheatsheet on whatsapp"
        href="https://api.whatsapp.com/send?text=Frida%20Cheatsheet%20-%20https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Frida Cheatsheet on telegram"
        href="https://telegram.me/share/url?text=Frida%20Cheatsheet&amp;url=https%3a%2f%2frehex.ninja%2fposts%2ffrida-cheatsheet%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://rehex.ninja">reHex Ninja</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
