<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on trib0r3&#39;s blog</title>
        <link>/posts/</link>
        <description>Recent content in Posts on trib0r3&#39;s blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Sun, 14 Jun 2020 09:42:17 +0200</lastBuildDate>
        <atom:link href="/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Nothing Is Lost in the Internet</title>
            <link>/posts/nothing-is-lost-in-the-internet/</link>
            <pubDate>Sun, 14 Jun 2020 09:42:17 +0200</pubDate>
            
            <guid>/posts/nothing-is-lost-in-the-internet/</guid>
            <description>&lt;p&gt;It  is very easy to upload something to the Internet, but hard to delete. This is short story about searching for &amp;ldquo;deleted&amp;rdquo; resources in the Internet.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>It  is very easy to upload something to the Internet, but hard to delete. This is short story about searching for &ldquo;deleted&rdquo; resources in the Internet.</p>
<h2 id="problem">Problem</h2>
<p>These methods may help you if want to access some Internet resource (like document or page), but it is no longer available because website is down or author decided to remove it.</p>
<h2 id="finding-removed-things">Finding &ldquo;removed&rdquo; things</h2>
<h3 id="website-mirrors">Website mirrors</h3>
<p>If you know where this resource is placed (you know it&rsquo;s url) the easiest method is to go to <a href="https://archive.org/web/">Web Archive</a>, type your url and select a mirror from the timeline.</p>
<h3 id="google-cache">Google cache</h3>
<p>Of course not all Internet resources are mirrored, so it may happen that web archive doesn&rsquo;t have saved url interesting for you. If your resource was deleted recently you can always search for it&rsquo;s search browser <em>cached</em> version, for google you need to type in search field:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">cache:&lt;url&gt;
</code></pre></div><p>You can also use other search browser to achieve similar results.</p>
<h3 id="hunting-for-deleted-things">Hunting for deleted things</h3>
<p>Finally if you don&rsquo;t know your resource url you can also use other search browser than google, like <a href="https://duckduckgo.com/">DuckDuckGo</a>. It may be useful, because google is removing dead url pretty quickly (it is also intentionally hiding some websites), so it is always good to use other search browsers.</p>]]></content>
        </item>
        
        <item>
            <title>Qiling Scripting and Simple RE Task</title>
            <link>/posts/qiling-scripting-and-simple-re-task/</link>
            <pubDate>Thu, 21 May 2020 14:53:08 +0200</pubDate>
            
            <guid>/posts/qiling-scripting-and-simple-re-task/</guid>
            <description>What is Qiling From the author&amp;rsquo;s website:
 Qiling is an advanced binary emulation framework, with the following features:
 Cross platform: Windows, MacOS, Linux, BSD Cross architecture: X86, X86_64, Arm, Arm64, Mips Multiple file formats: PE, MachO, ELF Emulate &amp;amp; sandbox machine code in a isolated environment Supports cross architecture and platform debugging capabilities Provide high level API to setup &amp;amp; configure the sandbox Fine-grain instrumentation: allow hooks at various levels (instruction/basic-block/memory-access/exception/syscall/IO/etc) Allow dynamic hotpatch on-the-fly running code, including the loaded library True framework in Python, making it easy to build customized security analysis tools on top  Qiling is backed by Unicorn engine.</description>
            <content type="html"><![CDATA[<h2 id="what-is-qiling">What is Qiling</h2>
<p>From the author&rsquo;s website:</p>
<blockquote>
<p>Qiling is an advanced binary emulation framework, with the following features:</p>
<ul>
<li>Cross platform: Windows, MacOS, Linux, BSD</li>
<li>Cross architecture: X86, X86_64, Arm, Arm64, Mips</li>
<li>Multiple file formats: PE, MachO, ELF</li>
<li>Emulate &amp; sandbox machine code in a isolated environment</li>
<li>Supports cross architecture and platform debugging capabilities</li>
<li>Provide high level API to setup &amp; configure the sandbox</li>
<li>Fine-grain instrumentation: allow hooks at various levels (instruction/basic-block/memory-access/exception/syscall/IO/etc)</li>
<li>Allow dynamic hotpatch on-the-fly running code, including the loaded library</li>
<li>True framework in Python, making it easy to build customized security analysis tools on top</li>
</ul>
<p>Qiling is backed by <a href="http://www.unicorn-engine.org">Unicorn engine</a>.</p>
</blockquote>
<p>Or just saying shortly: this tool will allow you to run binary from one system to another, i.e you can run Windows PE on Mac.</p>
<p>Additionally you can also utilize its scripting ability to hook addresses, run only part of binary, etc. Check the <a href="#references">references</a> to view project&rsquo;s GitHub page and others.</p>
<h2 id="simple-demo">Simple demo</h2>
<p>Let&rsquo;s imagine that we have this simple task:</p>
<p><img src="/img/task-code.png" alt="Task"></p>
<p>Obviously flag is generated from the stack strings with some on-the-fly operations, we can very easly capture the flag by setting couple of breakpoints in the debugger at addresses: <code>0x804852e</code> and <code>0x804853d</code> and check the contents of <em>eax</em> (notice that second part of the flag actually replaces the 1st part) or we can write simple script using Qiling:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> qiling <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> os <span style="color:#f92672">import</span> environ

EXEC_FILE <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;./task&#34;</span>]
ROOTFS <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{}/x86_linux&#34;</span><span style="color:#f92672">.</span>format(environ[<span style="color:#e6db74">&#34;QILING_ROOTFS&#34;</span>])
FLAG <span style="color:#f92672">=</span> []

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_hook</span>(ql : core<span style="color:#f92672">.</span>Qiling) <span style="color:#f92672">-&gt;</span> None:
    addr_flag <span style="color:#f92672">=</span> ql<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>eax
    FLAG<span style="color:#f92672">.</span>append(ql<span style="color:#f92672">.</span>mem<span style="color:#f92672">.</span>read(addr_flag, <span style="color:#ae81ff">0x13</span>))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_sandbox</span>(path, rootfs):
    ql <span style="color:#f92672">=</span> Qiling(path, rootfs)
    
    <span style="color:#75715e"># remove systrace logs</span>
    ql<span style="color:#f92672">.</span>filter <span style="color:#f92672">=</span> []

    ql<span style="color:#f92672">.</span>hook_address(on_hook, <span style="color:#ae81ff">0x804852e</span>)
    ql<span style="color:#f92672">.</span>hook_address(on_hook, <span style="color:#ae81ff">0x804853d</span>)
    ql<span style="color:#f92672">.</span>run()

    flag <span style="color:#f92672">=</span> FLAG[<span style="color:#ae81ff">0</span>][:<span style="color:#ae81ff">0x12</span>]<span style="color:#f92672">.</span>decode() <span style="color:#f92672">+</span> FLAG[<span style="color:#ae81ff">1</span>][:<span style="color:#ae81ff">7</span>]<span style="color:#f92672">.</span>decode()
    <span style="color:#66d9ef">print</span>(flag)

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    my_sandbox(EXEC_FILE, ROOTFS)
</code></pre></div><p>Some explanation: Qiling for execution requires 2 things:</p>
<ul>
<li>binary - what is obvious;</li>
<li>Rootfs - which should match target architecture.</li>
</ul>
<p>In my case environment variable <code>$QILING_ROOTFS</code> points to <code>$QILING_REPO_DIR/examples/rootfs</code>, above mentioned is a linux x86 binary so we are selecting <code>x68_linux</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> qiling <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> os <span style="color:#f92672">import</span> environ

EXEC_FILE <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;./task&#34;</span>]
ROOTFS <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{}/x86_linux&#34;</span><span style="color:#f92672">.</span>format(environ[<span style="color:#e6db74">&#34;QILING_ROOTFS&#34;</span>])
</code></pre></div><p>We want to <del>break</del> hook at specified addresses, so we can achieve that by calling <code>hook_address(callback, address)</code> I decided to reuse twice the same function, but you can create separate functions for that:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ql<span style="color:#f92672">.</span>hook_address(on_hook, <span style="color:#ae81ff">0x804852e</span>)
ql<span style="color:#f92672">.</span>hook_address(on_hook, <span style="color:#ae81ff">0x804853d</span>) 
</code></pre></div><p>After everything is setup we can run the binary with <code>ql.run()</code>.</p>
<p>Our hook method reads the value from <em>eax</em> register and saves it in global variable:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_hook</span>(ql : core<span style="color:#f92672">.</span>Qiling) <span style="color:#f92672">-&gt;</span> None:
    addr_flag <span style="color:#f92672">=</span> ql<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>eax
    FLAG<span style="color:#f92672">.</span>append(ql<span style="color:#f92672">.</span>mem<span style="color:#f92672">.</span>read(addr_flag, <span style="color:#ae81ff">0x13</span>))
</code></pre></div><p>Notice that we are reading twice the same amount of bytes (<code>ql.mem.read(addr_flag, 0x13)</code>), so we need to truncate these array before printing it on the screen:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    flag <span style="color:#f92672">=</span> FLAG[<span style="color:#ae81ff">0</span>][:<span style="color:#ae81ff">0x12</span>]<span style="color:#f92672">.</span>decode() <span style="color:#f92672">+</span> FLAG[<span style="color:#ae81ff">1</span>][:<span style="color:#ae81ff">7</span>]<span style="color:#f92672">.</span>decode()
    <span style="color:#66d9ef">print</span>(flag)
</code></pre></div><p>By default Qiling displays <code>strace</code> log, if you don&rsquo;t want to see it or you want to see only logs from specific methods you can use filters (you need to change this variable before running the qiling):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># mute strace log</span>
ql<span style="color:#f92672">.</span>filter <span style="color:#f92672">=</span> []

<span style="color:#75715e"># display only &#34;read&#34; functions</span>
ql<span style="color:#f92672">.</span>filter <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;read&#34;</span>]
</code></pre></div><blockquote>
<p><strong>Notice</strong>: the current version doesn&rsquo;t have working properly filters, so you need to switch to <code>dev</code> branch.</p>
</blockquote>
<p>Finally you can run it with python and see the flag:</p>
<p><img src="/img/qiling-flag.png" alt="flag"></p>
<h2 id="closing-notes">Closing notes</h2>
<p>Qiling is definately great framework, very simple to use and very powerful. Definately worth to try :)</p>
<h2 id="references">References</h2>
<ol>
<li><a href="https://github.com/qilingframework/qiling">Qiling Github</a></li>
<li><a href="docs.google.com/">Documentation</a></li>
</ol>
]]></content>
        </item>
        
        <item>
            <title>Comparision of Reverse-Engineering Tools</title>
            <link>/posts/comparision-of-re-tools/</link>
            <pubDate>Sun, 19 Apr 2020 12:12:00 +0200</pubDate>
            
            <guid>/posts/comparision-of-re-tools/</guid>
            <description>&lt;p&gt;Let&amp;rsquo;s compare the most populare reverse-egineering with strong focus on &lt;strong&gt;personal&lt;/strong&gt; usage: &lt;em&gt;BinaryNinja&lt;/em&gt;, &lt;em&gt;Ghidra&lt;/em&gt;, &lt;em&gt;IDA&lt;/em&gt; and &lt;em&gt;radare2&lt;/em&gt;.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Let&rsquo;s compare the most populare reverse-egineering with strong focus on <strong>personal</strong> usage: <em>BinaryNinja</em>, <em>Ghidra</em>, <em>IDA</em> and <em>radare2</em>.</p>
<p>Hopefully this post will help you to find tools worth choosing as primary reverse engineering tool.</p>
<h2 id="scoring-rules">Scoring rules</h2>
<p>To be fair during my analysis I developed simple score system. For each feature product can specific amount of points:</p>
<ol>
<li><strong>1.0</strong> (<code>+</code>) - given feature is available and fully operational.</li>
<li><strong>0.5</strong> (<code>~</code>) - feature is partially available, you need to install plugin to achieve it or pay for extra license.</li>
<li><strong>0.0</strong> (<code>-</code>)- feature is not available at all.</li>
</ol>
<h2 id="comparision">Comparision</h2>
<p>For detailed description of features go to corresponding chapters below.</p>
<p><strong>[Bracketed]</strong> character means that in my opinion specified tool is the &ldquo;best&rdquo; in the specified category (feature), it is not extra scored, but it may be useful for somebody.</p>
<pre><code>|                      | Price | Score | Cross-platform |   Multi-arch  |       Decompiler       | Debugger | Plugins (1)  | Signatures (2)  | Patching (3)  | Symbolic constants |
|:--------------------:|:-----:|:-----:|:--------------:|:-------------:|:----------------------:|:--------:|:------------:|:---------------:|:-------------:|:------------------:|
| BinaryNinja 2.0.2097 |  $150 |  7.0  |        +       |       +       |            +           |     +    |       +      |        +        |      [+]      |          -         |
|     Ghidra 9.1.2     |  Free |  6.5  |        +       |       +       |           [+]          |     -    |       ~      |        +        |       +       |          +         |
|      IDA Home(4)     |  $365 |  6.0  |  ~ (1/license) | ~ (1/license) | ~ (extra-paid feature) |    [+]   |       +      |       [+]       |       ~       |          +         |
|    radare2/Cutter    |  Free |  7.0  |       [+]      |      [+]      |            +           |     +    |       +      |        +        |       +       |          -         |
</code></pre><ol>
<li><strong>Plugins</strong> - support for modern, updated programming languages.</li>
<li><strong>Signatures</strong> - built-in signatures with option to add own.</li>
<li><strong>Patching</strong> - ability to assemble code without using the hex-editor.</li>
<li><strong>IDA Home</strong> - currently this version is not published yet, but this is just a limited IDA Pro version, so I will rate it based on my previous experiences with IDA Pro (for limitation list go to <a href="#references">References</a>).</li>
</ol>
<h3 id="price">Price</h3>
<p>Actually here is no winner, I would like to only mention that I skipped some freeware versions of paid tools:</p>
<ul>
<li><a href="https://cloud.binary.ninja/">BinaryNinja Cloud</a> - Binary Ninja Personal in browser, but without debugger and plugins support.</li>
<li><a href="https://www.hex-rays.com/products/ida/support/download_freeware/">IDA Freeware 7.0</a> - free version of IDA, with a lot of limitations.</li>
</ul>
<blockquote>
<p>To be 100% honest, BinaryNinja also have <a href="https://binary.ninja/demo/">standalone demo</a>, but it is more limited than cloud version, so I decided to ignore it.</p>
</blockquote>
<h3 id="score">Score</h3>
<p>Just remember to not blindly follow my scoring! This blog post is about my subjective point of view. If you want to know, which tool I like the most -&gt; jump to the <a href="#summary">summary</a>.</p>
<h3 id="cross-platform">Cross platform</h3>
<p>From my perspective disassembly tool should be cross-platform, it is very annoying when you can&rsquo;t <strong>easily</strong> install your tool on any operating system, specially when you are not staying with one favourite whole time (like me - I&rsquo;m the user of OSX, Linux &amp; Windows).</p>
<p>Unfortunatelly <em>IDA</em> is &ldquo;not the best&rdquo; here, because you need to specify on what kind of operating system you are going to use it :/</p>
<blockquote>
<p>Don&rsquo;t understand me wrong: you can disassemble Linux binaries on Windows and veice versa. But  it means that if you decide to buy it in version for Windows, then you will receive IDA install files only for Windows.</p>
</blockquote>
<p>The absolute winner is <em>radare2</em>, this tool you can run on almost anything (probably you can even run it on your washing machine).</p>
<h3 id="multi-arch-support-multiple-cpu-families">Multi-arch (support multiple CPU families)</h3>
<p>You never know when you will have change architecture of analysed software, probably you will do the most of analysis for x86 or ARM, but it is good to be ready for any kind of analysis, especially when you are paying for some tools.</p>
<p>Once again <em>IDA</em> is not cheap and supports only 1 architecture for each home license.</p>
<p><em>radare2</em> supports probably the biggest amount of architectures by default.</p>
<blockquote>
<p><strong>Note:</strong> the rest of tools probably requires only install of some plugin to support extra architecture - IDA Home is an exception.</p>
</blockquote>
<h3 id="decompiler">Decompiler</h3>
<p><img src="/img/ghidra.png" alt="Ghidra Decompiler"></p>
<p>Probably the most desired feature in every disassembly product. Unfortunatelly <em>IDA Home</em> won&rsquo;t have it built-in in this price and you need to pay full-price to get it (and this is very expensive toy).</p>
<blockquote>
<p><strong>Note:</strong> I really hate to hate IDA, because I like this tool, but IDA have also another disadvantage (without hex-rays): local variables doesn&rsquo;t support types.</p>
<p>This actually affects all plugins using i.e ghidra decompiler - if you have binary where some structure is created in the context of local variable, then you have to manually rename variables - even if definition of its structure is known for you.</p>
</blockquote>
<p>But anyway <em>Ghidra</em> seems to have the best decompiler at this moment (even better that <em>HexRays</em>): with support for C++ classes, etc. Definately the strongest feature of <em>Ghidra</em>.</p>
<p>For <em>Binja</em> it is relatively fresh stuff (it is available from version 2.0), so hopefully it will be similarly good as <em>Ghidra</em> (binja-devs we are waiting for support of classes!).</p>
<p>Finally <del>r2</del> <em>Cutter</em> have some decompiler, but seems to prefer to use ghidra&rsquo;s decompiler with as pretty good integration.</p>
<h3 id="debugger">Debugger</h3>
<p><img src="/img/ida-debugger.png" alt="IDA Debugger"></p>
<p>IDA is the winner and the loser at the same time. Definately the ugliest and the less intuitive interface, but it also have win-feature in debugger (even if debugger is sometimes bugged): populate current code state to database. Very useful during unpacking or dynamic code modifications.</p>
<blockquote>
<p><strong>Note:</strong> radare2 developed something called ESIL - very useful features for emulating code, analysis. Unfortunatelly it can&rsquo;t run code handled by operating system (APIs).</p>
</blockquote>
<blockquote>
<p><strong>Update:</strong> actually binja from some time also can populate analysis database based on debugging session! (it happens auto-magically)</p>
</blockquote>
<h3 id="plugins">Plugins</h3>
<p><img src="/img/binja-plugins.png" alt="BinaryNinja - plugins"></p>
<p>Here I had very simple requirements: plugin API must be available <strong>AND</strong> used language must be up to date.</p>
<p><em>Ghidra</em> failed here, because it is using <em>Java</em> or <em>Python2</em> (<em>Jython</em> to be honest). Just no.</p>
<p>I really like <em>radare2</em> API, because it is just radare syntax :P Then binja API seems to be very intuitive, IDA contains the most complex API.</p>
<blockquote>
<p><em>BinaryNinja</em> and <em>radare2</em> have plugin managers which helps you to install plugins &amp; keep them updated.</p>
</blockquote>
<h3 id="signatures">Signatures</h3>
<p><img src="/img/ida-lumina.png" alt="IDA Lumina"></p>
<p>Every dissasembly tool should have some mechanism for detecing commonly known functions and actually all of mentioned tools have such ability:</p>
<ul>
<li>BinaryNinja - own &ldquo;<a href="https://binary.ninja/2020/03/11/signature-libraries.html">Signatures</a>&rdquo; engine (I will work on support for FLIRT);</li>
<li>Ghidra - own signatures engine + FLIRT support (plugin required);</li>
<li>IDA Home - <a href="https://www.hex-rays.com/products/ida/tech/flirt/in_depth/">FLIRT</a>, support for Lumina server is not known is not known yet;</li>
<li>Radare2 - zignatures(<code>iz?</code>) + FLIRT.</li>
</ul>
<h3 id="patching">Patching</h3>
<p><img src="/img/binja-transform.png" alt="BinaryNinja - code transorm"></p>
<p>From my perspective <em>Binja</em> contains the best user interface for this (you can invert jumps, xor pieces of code, etc just by few clicks), pretty good interface is in <em>Cutter</em>, ofc if you are masochist you can everything in radare2 ;)</p>
<p>In IDA patching is theorethically possible, but I won&rsquo;t recommend it - much easier is to easier code in built-in hex editor than with very limited <em>Assemble code</em> feature.</p>
<h3 id="symbolic-contants">Symbolic contants</h3>
<p><img src="/img/ida-sym-const.png" alt="IDA Symbolic onstants"></p>
<p>Useful when you are analysing Windows binaries, just replace ugly int with more meaningful name.</p>
<h2 id="summary">Summary</h2>
<p>From my perspective if you are just looking for your 1st tool to begin with in reverse engineering, then I would recommend you <em>Ghidra</em> (I know, it&rsquo;s ugly - but it&rsquo;s free), then you can start thinking about buying i.e <em>BinaryNinja</em>.</p>
<p>Personally I very like <em>BinaryNinja</em> - for the interface and incoming features, it seems to become very good tool in the near feature. I can&rsquo;t also don&rsquo;t recommend <em>radare2</em> which is very powerful, but this tool requires a little bit more attention.</p>
<p><img src="/img/r2-learning.png" alt=""></p>
<p>I don&rsquo;t think that <em>IDA Home</em> is worth of waiting (it will be available in May), because it seems to be very limited in comparision to other tools - I can change my mind onluif it will contain <em>HexRays Decompiler</em> built-in in home version.</p>
<p>I hope this article will help you find your new favourite tool - if you have different opinion: please, share it in the comments :)</p>
<h2 id="references">References</h2>
<ol>
<li><a href="https://binary.ninja/">Binary Ninja</a></li>
<li><a href="https://www.ghidra-sre.org/">Ghidra</a></li>
<li><a href="https://www.hex-rays.com/products/ida-home-is-coming/">IDA Home</a></li>
<li><a href="https://rada.re/">radare2</a> &amp; <a href="https://cutter.re/">Cutter</a></li>
<li>Light Saber icon by <a href="http://delapouite.com">Delapouite</a> under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a></li>
</ol>]]></content>
        </item>
        
        <item>
            <title>Writeup - Securinets2020 Warmup</title>
            <link>/posts/writeup-securinets2020-warmup/</link>
            <pubDate>Sat, 28 Mar 2020 08:00:00 +0100</pubDate>
            
            <guid>/posts/writeup-securinets2020-warmup/</guid>
            <description>Warmup  Warmup : Welcome to securinets CTF
 In this task we are dealing with very simple function main:
undefined8 main(void) { int64_t iVar1; undefined8 uVar2; uint32_t var_8h; undefined8 var_4h; write(1, 0x988, 0x1a); read(0, 0x201080, 0x31); iVar1 = strlen(0x201080); *(undefined *)(iVar1 + 0x20107f) = 0; var_8h = 0; strcpy(rsi, 0x201080); uVar2 = strlen(0x201080); memfrob(0x201080, uVar2); var_4h._0_4_ = 0; while ((int32_t)var_4h &amp;lt; 0x14) { var_8h = var_8h + (int32_t)(char)(*(uint8_t *)((int64_t)(int32_t)var_4h + 0x201020) ^ *(uint8_t *)((int64_t)(int32_t)var_4h + 0x201080)); var_4h.</description>
            <content type="html"><![CDATA[<h1 id="warmup">Warmup</h1>
<blockquote>
<p>Warmup : Welcome to securinets CTF</p>
</blockquote>
<p>In this task we are dealing with very simple function main:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">undefined8 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
{
    int64_t iVar1;
    undefined8 uVar2;
    uint32_t var_8h;
    undefined8 var_4h;
    
    write(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x988</span>, <span style="color:#ae81ff">0x1a</span>);
    read(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x201080</span>, <span style="color:#ae81ff">0x31</span>);
    iVar1 <span style="color:#f92672">=</span> strlen(<span style="color:#ae81ff">0x201080</span>);
    <span style="color:#f92672">*</span>(undefined <span style="color:#f92672">*</span>)(iVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x20107f</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    var_8h <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    strcpy(rsi, <span style="color:#ae81ff">0x201080</span>);
    uVar2 <span style="color:#f92672">=</span> strlen(<span style="color:#ae81ff">0x201080</span>);
    memfrob(<span style="color:#ae81ff">0x201080</span>, uVar2);
    var_4h._0_4_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">while</span> ((int32_t)var_4h <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x14</span>) {
        var_8h <span style="color:#f92672">=</span> var_8h <span style="color:#f92672">+</span> (int32_t)(<span style="color:#66d9ef">char</span>)(<span style="color:#f92672">*</span>(uint8_t <span style="color:#f92672">*</span>)((int64_t)(int32_t)var_4h <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x201020</span>) <span style="color:#f92672">^</span>
                                         <span style="color:#f92672">*</span>(uint8_t <span style="color:#f92672">*</span>)((int64_t)(int32_t)var_4h <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x201080</span>));
        var_4h._0_4_ <span style="color:#f92672">=</span> (int32_t)var_4h <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#66d9ef">if</span> (var_8h <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
        printf(<span style="color:#ae81ff">0x9a8</span>, rsi);
    } <span style="color:#66d9ef">else</span> {
        puts(<span style="color:#ae81ff">0x9d5</span>);
    }
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}

</code></pre></div><p>In this function the <code>memfrob</code> is used, from manual you can learn that this function is xoring buffer with key <code>42</code>, solution:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;&gt;</span> a <span style="color:#f92672">=</span> [  <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x47</span>,
<span style="color:#f92672">...</span>   <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x53</span>]
<span style="color:#f92672">&gt;&gt;&gt;</span> r <span style="color:#f92672">=</span> []
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> a:
<span style="color:#f92672">...</span>   r<span style="color:#f92672">.</span>append(b<span style="color:#f92672">^</span><span style="color:#ae81ff">42</span>)
<span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> r
[<span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">109</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">117</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">121</span>]
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join([chr(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> r])
<span style="color:#e6db74">&#34;l3t&#39;s_w4rm_1t_up_boy&#34;</span>
</code></pre></div><p>And execution:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Welcome to SECURINETS CTF
l3t&#39;s_w4rm_1t_up_boy
Good job
You can submit with securinets{l3t&#39;s_w4rm_1t_up_boy}
</code></pre></div>]]></content>
        </item>
        
        <item>
            <title>Writeup - HTB Snake</title>
            <link>/posts/writeup-htb-snake/</link>
            <pubDate>Fri, 27 Mar 2020 19:22:09 +0100</pubDate>
            
            <guid>/posts/writeup-htb-snake/</guid>
            <description>[re] Snake (10) Description Short info about task:
 Name: Snake Difficulty: easy Score: 10   Flag should be in the format: HTB{username:password}
 Overview We have got the python script that is waiting for some username and password:
$ python snake.py ___________.__ _________ __ \__ ___/| |__ ____ / _____/ ____ _____ | | __ ____ | | | | \_/ __ \ \_____ \ / \__ \ | |/ // __ \ | | | Y \ ___/ / \ | \/ __ \| &amp;lt;\ ___/ |____| |___| /\___ &amp;gt; /_______ /___| (____ /__|_ \___ &amp;gt; \/ \/ \/ \/ \/ \/ \/ The Snake Created by 3XPL017 Your number is 809 Authentication required Enter your username QWE Wrong username try harder Let&amp;rsquo;s look into code to get more info about how to get username and password.</description>
            <content type="html"><![CDATA[<h1 id="re-snake-10">[re] Snake (10)</h1>
<h2 id="description">Description</h2>
<p>Short info about task:</p>
<ul>
<li><strong>Name:</strong> Snake</li>
<li><strong>Difficulty:</strong> <em>easy</em></li>
<li><strong>Score:</strong> 10</li>
</ul>
<blockquote>
<p>Flag should be in the format: HTB{username:password}</p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>We have got the python script that is waiting for some username and password:</p>
<pre><code>$ python snake.py

___________.__               _________              __
\__    ___/|  |__   ____    /   _____/ ____ _____  |  | __ ____
 |    |   |  |  \_/ __ \   \_____  \ /    \__  \ |  |/ // __ \
 |    |   |   Y  \  ___/   /        \   |  \/ __ \|    &lt;\  ___/
 |____|   |___|  /\___  &gt; /_______  /___|  (____  /__|_ \___  &gt;
               \/     \/          \/     \/     \/     \/    \/


The Snake Created by 3XPL017
Your number is 809
Authentication required

Enter your username
QWE
Wrong username try harder
</code></pre><p>Let&rsquo;s look into code to get more info about how to get username and password.</p>
<h2 id="bypass-code">Bypass code</h2>
<p>We can see partially obfuscated variables, that are later xored with some values, let&rsquo;s try to get username.</p>
<h3 id="username">Username</h3>
<p>Username is combined from random dropped variables that are of course hex-encoded letters (i.e <code>db = '\x6e'</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">user_input <span style="color:#f92672">=</span> raw_input(<span style="color:#e6db74">&#39;Enter your username</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#66d9ef">if</span> user_input <span style="color:#f92672">==</span> slither:
    <span style="color:#66d9ef">pass</span>

<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Wrong username try harder&#39;</span>
    exit()
</code></pre></div><p>To get correct username we should know the slither value, we can easly get it by printing before verification check.</p>
<p>I&rsquo;ve decided to &lsquo;patch&rsquo; above code into:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">user_input <span style="color:#f92672">=</span> slither
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;====&gt; Username: {}&#34;</span><span style="color:#f92672">.</span>format(user_input)
<span style="color:#66d9ef">if</span> user_input <span style="color:#f92672">==</span> slither:
    <span style="color:#66d9ef">pass</span>
</code></pre></div><pre><code>&gt; python snake.py

___________.__               _________              __
\__    ___/|  |__   ____    /   _____/ ____ _____  |  | __ ____
  |    |   |  |  \_/ __ \   \_____  \ /    \__  \ |  |/ // __ \
  |    |   |   Y  \  ___/   /        \   |  \/ __ \|    &lt;\  ___/
  |____|   |___|  /\___  &gt; /_______  /___|  (____  /__|_ \___  &gt;
                \/     \/          \/     \/     \/     \/    \/


The Snake Created by 3XPL017
Your number is 351
Authentication required

====&gt; Username: anaconda
Enter your password
PASSWORD
Wrong password try harder
</code></pre><p>Yay, so the username is <code>anaconda</code>, now we need to guess password.</p>
<h3 id="password">Password</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pass_input <span style="color:#f92672">=</span> raw_input(<span style="color:#e6db74">&#39;Enter your password</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#66d9ef">for</span> passes <span style="color:#f92672">in</span> pass_input:
    <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> chars:
        <span style="color:#66d9ef">if</span> passes <span style="color:#f92672">==</span> str(chr(char)):
            <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Good Job&#39;</span>
            <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Wrong password try harder&#39;</span>
            exit(<span style="color:#ae81ff">0</span>)
    <span style="color:#66d9ef">break</span>
</code></pre></div><p>This part is much harder, because every input which starts with <code>'u'</code> is accepted (we can realize it by checking runtime to which letter input is compared). This is probably &ldquo;programming mistake&rdquo;, now we should guess what author wanted to achieve - what kind of verification.</p>
<p>We can also get all chars array (<code>[117, 100, 118, 118, 114, 106, 119, 97, 36, 36, 126, 114, 115, 125, 42, 115, 125, 42, 107, 42, 126, 124, 121, 118, 118]</code>) and print this as string: <code>&quot;udvvrjwa$$~rs}*s}*k*~|yvv&quot;</code>, but this is not our password :/</p>
<p>Making a step back, by ignoring loop where chars are incremented by <code>0xA</code> we can read that chars is just a message: <code>&quot;this is a troll&quot;</code>, so the real password is somewhere else.</p>
<p>We can also notice unused variable password: <code>password = [0x69, 0x74, 0x73, 0x20, 0x6e, 0x6f, 0x74, 0x20, 0x74, 0x68, 0x61, 0x74, 0x20, 0x65, 0x61, 0x73, 0x79]</code>, but this is just another rabbit hole:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;&gt;</span> password <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x79</span>]
<span style="color:#f92672">&gt;&gt;&gt;</span> s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> password:
<span style="color:#f92672">...</span>   s <span style="color:#f92672">+=</span> chr(c)
<span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> s
<span style="color:#e6db74">&#39;its not that easy&#39;</span>
</code></pre></div><p>With some additional prints we can notice that output and <code>lock = 5</code> variable are the same:</p>
<pre><code>==&gt; chains: this is a troll
==&gt; keys: password!!
==&gt; auth: keep trying
Your number is 774
Lock 5
==&gt; chars1: udvvrjwa$$
==&gt; chars2: udvvrjwa$$~rs}*s}*k*~|yvv
</code></pre><p>My simplified code which gives above result:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python2.7</span>
<span style="color:#f92672">import</span> random 

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_array</span>(name, chars):
    r <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> chars:
        r <span style="color:#f92672">+=</span> chr(c)
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;==&gt; {}: {}&#34;</span><span style="color:#f92672">.</span>format(name, r)

chains <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6c</span>]
keys <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x21</span>]
auth <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x67</span>]

print_array(<span style="color:#e6db74">&#34;chains&#34;</span>, chains)
print_array(<span style="color:#e6db74">&#34;keys&#34;</span>, keys)
print_array(<span style="color:#e6db74">&#34;auth&#34;</span>, auth)

chars <span style="color:#f92672">=</span> []

lock_pick <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x3e8</span>)
lock <span style="color:#f92672">=</span> lock_pick <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
lock <span style="color:#f92672">=</span> lock <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>
lock <span style="color:#f92672">=</span> lock <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
lock <span style="color:#f92672">=</span> lock <span style="color:#f92672">-</span> lock_pick

<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Your number is &#39;</span> <span style="color:#f92672">+</span> str(lock_pick)
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Lock &#39;</span> <span style="color:#f92672">+</span> str(lock)

<span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> keys:
    keys_encrypt <span style="color:#f92672">=</span> lock <span style="color:#f92672">^</span> key
    chars<span style="color:#f92672">.</span>append(keys_encrypt)

print_array(<span style="color:#e6db74">&#34;chars1&#34;</span>, chars)
<span style="color:#66d9ef">for</span> chain <span style="color:#f92672">in</span> chains:
    chains_encrypt <span style="color:#f92672">=</span> chain <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xA</span>
    chars<span style="color:#f92672">.</span>append(chains_encrypt)
print_array(<span style="color:#e6db74">&#34;chars2&#34;</span>, chars)


pass_input <span style="color:#f92672">=</span> raw_input(<span style="color:#e6db74">&#39;Enter your password</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#66d9ef">for</span> passes <span style="color:#f92672">in</span> pass_input:
    <span style="color:#66d9ef">print</span> chars
    <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> chars:
        <span style="color:#66d9ef">if</span> passes <span style="color:#f92672">==</span> str(chr(char)):
            <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Good Job&#39;</span>
            <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Wrong password try harder&#39;</span>
            exit(<span style="color:#ae81ff">0</span>)
    <span style="color:#66d9ef">break</span>
</code></pre></div><p>After we delete &lsquo;troll-part&rsquo; of password we can check the flag : <code>HTB{anaconda:udvvrjwa$$}</code> we will get a success.</p>
<h2 id="summary">Summary</h2>
<p>After we will make some understanding of all strings, variables and code we can get the flag, but to be clear: this is more like <em>try every possible flag</em> challenge, than challenge which will allow you to learn something.</p>
<p>It&rsquo;s just internet troll - but not very funny.</p>
]]></content>
        </item>
        
        <item>
            <title>Ida Pro Plugins</title>
            <link>/posts/ida-pro-plugins/</link>
            <pubDate>Sat, 15 Feb 2020 12:01:53 +0100</pubDate>
            
            <guid>/posts/ida-pro-plugins/</guid>
            <description>&lt;p&gt;Plugins worth installing&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Plugins worth installing</p>
<ul>
<li><a href="https://github.com/OALabs/FindYara">FindYara</a> - use yara rules for looking into binary</li>
<li><a href="https://github.com/polymorf/findcrypt-yara">Findcrypt YARA</a> - find crypto structs with yara rules</li>
<li><a href="https://github.com/vrtadmin/FIRST">FIRST</a> - community driven Lunsa function matching plugin</li>
<li><a href="https://github.com/CheckPointSW/Karta">Karta</a> - open source lib functions matching</li>
<li><a href="https://github.com/joxeankoret/diaphora">Diaphora</a> - diff binaries</li>
<li><a href="https://github.com/hasherezade/ida_ifl">IDA IFL</a> - interactive function list</li>
<li><a href="https://github.com/cseagle/blc">blc</a> - decompiler based on Ghidra</li>
<li><a href="https://retdec.com/idaplugin/">retdec</a> - standalone decompiler</li>
</ul>]]></content>
        </item>
        
        <item>
            <title>Expose Any Port With Ngrok</title>
            <link>/posts/expose-any-port-with-ngrok/</link>
            <pubDate>Sat, 01 Feb 2020 13:53:37 +0100</pubDate>
            
            <guid>/posts/expose-any-port-with-ngrok/</guid>
            <description>&lt;p&gt;How to expose any port to the Internet without exposing your private IP (for free).&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>How to expose any port to the Internet without exposing your private IP (for free).</p>
<p>Today I will show you how to easly setup exposure of any port without exposing your IP, this solution also bypasses situation when your ISP is not giving possibility to have private (own) IP address which is not behind any NAT.</p>
<p>I used this solution to create access (for myself) to SSH and locally hosted security camera system at my home.</p>
<h2 id="1-setup-ngrok">1. Setup NGrok</h2>
<p>First of all you need to have an ngrok account<a href="#references">[1]</a> - free account is enough for our purposes. Generally ngrok is a reverse-proxy service where you need tun ngrok client on target machine, client enables connection with ngrok server and then you are able to connect with your machine (where ngrok client is running) via Internet.</p>
<blockquote>
<p>Free acount forwards local port as random remote port (usually under const hostname: <code>0.tcp.ngrok.io</code> for tcp tunnels)</p>
</blockquote>
<p>After you have account you need to download client and activate account with your API key (follow the instuctions from web service).</p>
<h2 id="2-verify-that-tunnel-works">2. Verify that tunnel works</h2>
<p>Create ngrok config file (under <code>~/.ngrok2/ngrok.yml</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#66d9ef">authtoken</span>: &lt;YOUR_TOKEN_HERE&gt;
<span style="color:#66d9ef">tunnels</span>:
        <span style="color:#66d9ef">sshglob</span>:
                <span style="color:#66d9ef">proto</span>: tcp
                <span style="color:#66d9ef">addr</span>: <span style="color:#ae81ff">22</span>
</code></pre></div><p>Above config setups tunnel <code>sshglob</code> which forwards locally hosted <code>tcp/22</code> - in this case SSH service. You should change these values according to your needs.</p>
<p>Now you can try to start ngrok <code>ngrok start sshglob</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">ngrok by @inconshreveable                                                            (Ctrl+C to quit)

Session Status                online
Account                       whoami (Plan: Free)
Version                       2.3.35
Region                        United States (us)
Web Interface                 http://127.0.0.1:4040
Forwarding                    tcp://0.tcp.ngrok.io:13036 -&gt; localhost:22

Connections                   ttl     opn     rt1     rt5     p50     p90
                              0       0       0.00    0.00    0.00    0.00
</code></pre></div><p>Now you should be able to connect with ssh (in my case) with command: <code>ssh -p 13036 whoami@0.tcp.ngrok.io</code>.</p>
<p>If you don&rsquo;t have any issues with accessing you machine over Internet you are free to follow next steps :) (otherwise check <a href="#troubleshooting">Troubleshooting</a> section).</p>
<h2 id="3-bypass-random-port-issue">3. Bypass random port issue</h2>
<p>If you run ngrok couple of times you should notice that every time you service is running at random port, to bypass this issue you can by a premium or make some additional steps presented below.</p>
<h3 id="install-dependencies">Install dependencies</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt install -y python3 python3-pip curl jq
pip3 install telegram
</code></pre></div><h3 id="setup-telegram-bot">Setup Telegram bot</h3>
<p>For myself I decided to create Telegram<a href="#references">[2]</a> bot which will send me external hostname and random IP address. Ofc you need to have created Telegram account to follow next steps.</p>
<ol>
<li>Start conversation with telegram <a href="https://t.me/botfather">Botfather</a>.</li>
<li>Type commands in Botfather conversation:</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/newbot
mysuper_bot <span style="color:#75715e"># replace &#34;mysuper&#34; with your bot name</span>
</code></pre></div><ol start="3">
<li>Copy API key and start conversation with your bot</li>
<li>Type something in the chat &amp; run the below code:</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> argv
<span style="color:#f92672">import</span> telegram

bot <span style="color:#f92672">=</span> telegram<span style="color:#f92672">.</span>Bot(token<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YOUR_API_KEY&#34;</span>)
<span style="color:#66d9ef">print</span>(bot<span style="color:#f92672">.</span>getUpdates())
</code></pre></div><ol start="5">
<li>Copy <code>chat_id</code></li>
<li>Create script <code>tsend.py</code>:</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> argv
<span style="color:#f92672">import</span> telegram

bot <span style="color:#f92672">=</span> telegram<span style="color:#f92672">.</span>Bot(token<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YOUR_API_KEY&#34;</span>) <span style="color:#75715e"># FIXME your api key</span>
chat_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">1234</span> <span style="color:#75715e"># FIXME YOUR_CHAT_ID</span>
raw_msg <span style="color:#f92672">=</span> argv[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;&#34;&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;tcp://&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)  <span style="color:#75715e"># &#34;tcp://0.tcp.ngrok.io:10361&#34;</span>
ip,port <span style="color:#f92672">=</span> raw_msg<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;:&#39;</span>)

message <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#39;{ip}:{port}&#39;</span>
bot<span style="color:#f92672">.</span>send_message(chat_id<span style="color:#f92672">=</span>chat_id, text<span style="color:#f92672">=</span>message)
</code></pre></div><ol start="7">
<li>Check if you are able to send message to you from your bot by typing <code>python3 tsend.py hello</code>.</li>
</ol>
<h3 id="make-your-service-always-available">Make your service always available</h3>
<p>Final step, below script will:</p>
<ol>
<li>Start ngrok tunnel if it is not running</li>
<li>Send you actual <code>IP:PORT</code> thanks to telegram bot</li>
</ol>
<blockquote>
<p>Below script is designed to be run from cron, thanks to this solution it will be run automatically i.e every 5 minutes:
<code>*/5 * * * * path/to/monitor.sh</code></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># monitor.sh</span>
<span style="color:#75715e">#!/bin/bash</span>

NGROK<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/usr/local/bin/ngrok&#39;</span>
DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/ngrok-apps&#34;</span> <span style="color:#75715e"># directory containing this script and tsend.py</span>
URL_DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/tmp/ngrok-url&#39;</span>

<span style="color:#75715e"># check if it&#39;s working</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>pidof ngrok<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;[ngrok] is not working, starting new instance...&#34;</span>
        $NGROK start sshglob &gt; /dev/null &amp;
        sleep <span style="color:#ae81ff">3</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#75715e"># get current status of tunnel</span>
NEW_STATUS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>curl -s http://127.0.0.1:4040/api/tunnels | jq <span style="color:#e6db74">&#39;.tunnels[0] .public_url&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
echo <span style="color:#e6db74">&#34;[ngrok] </span><span style="color:#66d9ef">$(</span>date<span style="color:#66d9ef">)</span><span style="color:#e6db74"> </span>$NEW_STATUS<span style="color:#e6db74">&#34;</span>
OLD_STATUS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -e <span style="color:#e6db74">&#34;</span>$URL_DIR<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
        OLD_STATUS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>cat $URL_DIR<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#75715e"># check if differ</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$NEW_STATUS<span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span>$OLD_STATUS<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;[ngrok] New status detected! Updating IP&#34;</span>
        echo <span style="color:#e6db74">&#34;</span>$NEW_STATUS<span style="color:#e6db74">&#34;</span> &gt; <span style="color:#e6db74">&#34;</span>$URL_DIR<span style="color:#e6db74">&#34;</span>
        python3 <span style="color:#e6db74">&#34;</span>$DIR<span style="color:#e6db74">/tsend.py&#34;</span> <span style="color:#e6db74">&#34;</span>$NEW_STATUS<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>If everything works you should receive notification to your telegram if IP or port will change.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<h4 id="my-ngrok-tunnel-is-started-but-i-cant-access-service">My ngrok tunnel is started, but I can&rsquo;t access service</h4>
<p>Is this service running also on localhost? Or can you reach shown ngrok host (IP)?</p>
<h3 id="can-i-use-something-else-than-telegram">Can I use something else than telegram?</h3>
<p>Yes, but I had already telegram in place. If you need you can use i.e Discord, Slack, mail, etc. (but you need to modify <code>tsend.py</code> script)</p>
<h2 id="references">References</h2>
<ol>
<li><a href="https://ngrok.com/">https://ngrok.com/</a></li>
<li><a href="https://telegram.org/">https://telegram.org/</a></li>
</ol>]]></content>
        </item>
        
        <item>
            <title>Unmap PE Manually</title>
            <link>/posts/unmap-pe-manually/</link>
            <pubDate>Sat, 25 Jan 2020 09:00:00 +0100</pubDate>
            
            <guid>/posts/unmap-pe-manually/</guid>
            <description>Prerequisities  Make sure that you have dumped binary from memory (optionally) Fix PE headers if necessary  Unmap With PE bear  Open PE-bear &amp;gt; Sections &amp;gt; Section Headers Make sure that VA and VS matches RA and RS, so:  RA[i] = VA[i] RS[i] = RA[i+1] - RA[i] RS.reloc = 0 VS[i] = RS[i]   If you see some red blocks it means that PE is probably misalligned, check: Fix misalligned sections  Fix misalligned sections  Open binary in hex editor Go to the 1st section (on example above to 0x1000) Section should start in this place, nulls should be before.</description>
            <content type="html"><![CDATA[<h2 id="prerequisities">Prerequisities</h2>
<ol>
<li>Make sure that you have dumped binary from memory</li>
<li>(optionally) Fix PE headers if necessary</li>
</ol>
<h2 id="unmap">Unmap</h2>
<h3 id="with-pe-bear">With PE bear</h3>
<ol>
<li>Open <em>PE-bear</em> &gt; <em>Sections</em> &gt; <em>Section Headers</em></li>
<li>Make sure that VA and VS matches RA and RS, so:
<ol>
<li>RA[i] = VA[i]</li>
<li>RS[i] = RA[i+1] - RA[i]</li>
<li>RS.reloc = 0</li>
<li>VS[i] = RS[i]</li>
</ol>
</li>
<li>If you see some red blocks it means that PE is probably misalligned, check: <em>Fix misalligned sections</em></li>
</ol>
<p><img src="/img/unmap-pe.png" alt="UnmapPE"></p>
<h3 id="fix-misalligned-sections">Fix misalligned sections</h3>
<p><img src="/img/unmap-hex1.png" alt="Dump1"></p>
<ol>
<li>Open binary in hex editor</li>
<li>Go to the 1st section (on example above to <code>0x1000</code>)</li>
<li>Section should start in this place, nulls should be before.</li>
<li>Append nulls starting from last null seen before 1st section (<code>0xfdf</code>) to section start address (inconclusive) (<code>0x1000</code>)</li>
<li>Save.</li>
<li>Review in <em>PE Bear</em>:
<ol>
<li><code>Sections</code> &gt; <code>Section Headers</code> should no longer be marked as read.</li>
<li>if <code>Section Headers </code> &gt; <code>Image Base</code> is the same as dumped section address (if not, set it to dumped section address).</li>
</ol>
</li>
</ol>
<p><img src="/img/unmap-hex2.png" alt="Dump2"></p>
]]></content>
        </item>
        
        <item>
            <title>Disable Aslr</title>
            <link>/posts/disable-aslr/</link>
            <pubDate>Sat, 18 Jan 2020 14:00:15 +0100</pubDate>
            
            <guid>/posts/disable-aslr/</guid>
            <description>Linux echo 0 | sudo tee /proc/sys/kernel/randomize_va_space radare2 # disable ASLR &amp;amp; reanalyse dor aslr=no aaa Windows Windows 7  Open RegEdit Goto: HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\ Create new value (not a key): MoveImages with value 0. Reboot.  Windows 10 Disable ASLR per file Set-Processmitigation -Name name.exe -Disable ForceRelocateImages Disable ASLR by default  Search in Windows for: “windows defender Security Center” Click on the second icon from the bottom: “App &amp;amp; browser control” Scroll to the bottom and click on: “Exploit protection settings” Set “Force randomization for images “ to OFF.</description>
            <content type="html"><![CDATA[<h2 id="linux">Linux</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#ae81ff">0</span> | sudo tee /proc/sys/kernel/randomize_va_space
</code></pre></div><h3 id="radare2">radare2</h3>
<pre><code class="language-r2" data-lang="r2"># disable ASLR &amp; reanalyse
dor aslr=no
aaa
</code></pre><h2 id="windows">Windows</h2>
<h3 id="windows-7">Windows 7</h3>
<ol>
<li>Open <code>RegEdit</code></li>
<li>Goto: <code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\</code></li>
<li>Create new <em>value</em> (not a key): <code>MoveImages</code> with value <code>0</code>.</li>
<li>Reboot.</li>
</ol>
<h3 id="windows-10">Windows 10</h3>
<h4 id="disable-aslr-per-file">Disable ASLR per file</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Set-Processmitigation -Name name.exe -Disable ForceRelocateImages
</code></pre></div><h4 id="disable-aslr-by-default">Disable ASLR by default</h4>
<ol>
<li>Search in Windows for: “windows defender Security Center”</li>
<li>Click on the second icon from the bottom: “App &amp; browser control”</li>
<li>Scroll to the bottom and click on: “Exploit protection settings”</li>
<li>Set “Force randomization for images “ to <em>OFF</em>.</li>
<li>Reboot</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://oalabs.openanalysis.net/2019/06/12/disable-aslr-for-easier-malware-debugging/">Disable ASLR for Easier Malware Debugging With x64dbg and IDA Pro</a></li>
<li><a href="https://gist.github.com/trietptm/b84ccad9db01f459ac7e">Gist</a></li>
<li><a href="https://www.reddit.com/r/ReverseEngineering/comments/bzn06z/disable_aslr_for_easier_malware_debugging_with/">Disable ASLR For Easier Malware Debugging With x64dbg and IDA Pro (OALabs Quick Tip) : ReverseEngineering</a></li>
</ul>
]]></content>
        </item>
        
        <item>
            <title>Keep Your Notes Organized (bear2mdtree demo)</title>
            <link>/posts/keep-your-md-notes-organized/</link>
            <pubDate>Sat, 18 Jan 2020 09:00:00 +0100</pubDate>
            
            <guid>/posts/keep-your-md-notes-organized/</guid>
            <description>Journey of finding ideal note-taking app  TL;DR: If you want to transfer your bear notes to markdown goto Move your bear notes, if you want to emulate Bear multi-tagging check Multitagging support.
 Once upon a time I was using Bear.app for writing and organizing notes. It had really good features like multi-tagging and couple of other nice features like pseudo markdown support. Unfortunatelly a lot of things were bugged, developers slow in fixing them so I decided to move my notes from Bear to other platform.</description>
            <content type="html"><![CDATA[<h2 id="journey-of-finding-ideal-note-taking-app">Journey of finding ideal note-taking app</h2>
<blockquote>
<p>TL;DR: If you want to transfer your bear notes to markdown goto <a href="#Moving-bear-notes">Move your bear notes</a>, if you want to emulate <em>Bear</em> multi-tagging check <a href="#multitagging-support">Multitagging support</a>.</p>
</blockquote>
<p>Once upon a time I was using <a href="https://bear.app">Bear.app</a> for writing and organizing notes. It had really good features like multi-tagging and couple of other nice features like pseudo markdown support. Unfortunatelly a lot of things were bugged, developers slow in fixing them so I decided to move my notes from <em>Bear</em> to other platform.</p>
<h3 id="requirements">Requirements</h3>
<p>I wanted to have these features:</p>
<ul>
<li>WYSWIG (What You See Is What You Get) editor with only 1 pane,</li>
<li>Notes should be kept / written in Markdown,</li>
<li>Support image pasting from clipboard,</li>
<li>Sync,</li>
<li>Support for nested tags(1),</li>
<li>Support for multi-tagging(2).</li>
</ul>
<h4 id="1-nested-tags">(1) Nested tags</h4>
<p>We can have tree-like tags, i.e notes assigned to: <code>tag1/sub1</code>, will be also visible in <code>tag1</code>, but not in <code>tag2/sub1</code> (defferent parent).</p>
<h4 id="2-multi-tagging">(2) Multi-tagging</h4>
<p>Notes can belong to multiple tags, so they should be visible from multiple tag sub-trees.</p>
<h2 id="ideal-doesnt-exists-but">Ideal doesn&rsquo;t exists, but&hellip;</h2>
<p>Finally I couldn&rsquo;t find ideal substitute for <em>Bear</em>, so I decided to move into some WYSWIG Markdown editor which will nicely present meta-data for multi-tagging - I will take care about the rest of mine requirements.</p>
<p>I decided to move to <a href="https://typora.io/">Typora</a> - it is not perfect, but it seems to work fine. Moving to editor based on directory tree (folders = tags) have one big disadvantage - we can&rsquo;t have multiple tags (but nested tags are working nicely). I had idea how to overcome this issue.</p>
<h3 id="prerequirements">Prerequirements</h3>
<ol>
<li>Clone my repo <a href="https://github.com/trib0r3/bear2markdowntree">bear2markdowntree</a>.</li>
<li>Follow step (1) and (2) from <em>How to</em> section.</li>
</ol>
<h3 id="move-your-bear-notes">Move your bear notes</h3>
<p>First of all I created a concept of &ldquo;main tag&rdquo;, so if note have multiple tags (i.e <code>tag1/sub1</code> and <code>tag2/sub2</code>) we have to choose which tag is more important to us. The <em>main tag</em> will be actually translated into directory structure in your notes directory and saved there! The rest of the tags will be added into note as YAML meta-data.</p>
<p>For example: you have exported <em>bear</em> note to <code>$BEAR_DIR/note.md</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown"># Note

My note

#tag1/sub1 #tag2/sub2
</code></pre></div><p>After exporting this note with my script and selecting <code>#tag1/sub1</code> as main tag, the note will be saved under <code>$NOTES_DIR/tag1/sub1/note.md</code> and it will look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown">---
tags: [&#34;tag1/sub1&#34;, &#34;tag2/sub2&#34;]
---
# Note

My note
</code></pre></div><h4 id="demo">Demo</h4>
<p>Before running <code>export-bear2typora.py</code> don&rsquo;t forget setup script by editing it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># config dirs</span>
NOTE_DIR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Notes/&#34;</span>         <span style="color:#75715e"># output dir</span>
BEAR_DIR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BearNotes/&#34;</span>     <span style="color:#75715e"># input dir</span>
</code></pre></div><p>Paths are relative to script path, during script execution you can be prompted for tag selection. During this you can also jump into python interactive session and fix tag name if something was wrongly matched (minimum knowledge of python is required) - tags are kept in <code>tags</code> array.</p>
<p>After this process you should have exported and fixed notes in your <code>BEAR_DIR</code>.</p>
<h3 id="multitagging-support">Multitagging support</h3>
<p>This topic is actually nicely described in <a href="https://github.com/trib0r3/bear2markdowntree#multi-tagging-support">README</a>. We can emulate multi-tags structure by symbolic links (but with some problems on Windows and in Typora) or by creating special file which I called <em>index</em>.</p>
<p>This file should be (re)generated with <code>build-tags.py</code> each time you decide to put some new file in your directory list.</p>
<p>Here you should edit only one variable (if you have <code>NOTES_DIR</code> relative to home directory):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">HOME_USER <span style="color:#f92672">=</span> str(Path<span style="color:#f92672">.</span>home())
NOTES_DIR <span style="color:#f92672">=</span> HOME_USER <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/Dropbox/Notes/&#34;</span> <span style="color:#75715e"># FIXME:  add path to your Notes folder (relative to $HOME)</span>
</code></pre></div><p>If you want to use absoulte path change code to:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">NOTES_DIR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/root/home/notes/&#34;</span>
</code></pre></div><p>Additionally if you don&rsquo;t want to see some tags, you can add them here:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># If you want ignore some tags in the final listing add them to this list</span>
<span style="color:#75715e"># WARNING: this feature is actually taking only subtag, </span>
<span style="color:#75715e">#  Ex#1: you have note with tag: &#34;dev/python/code-snippets&#34;</span>
<span style="color:#75715e">#    if you decide to ignore tag &#34;dev&#34;, then all subtags (&#34;python&#34;, &#34;code-snippets&#34;)  will be also ignored!</span>
<span style="color:#75715e">#  Ex#2: you have 2 notes with tags: note1: &#39;q/w/e&#39;, &#39;e/w/q&#39; (you have the same subtab &#39;w&#39;, but in totally different subtrees)</span>
<span style="color:#75715e">#    Ignoring tag &#39;w&#39; will affect BOTH subtrees, </span>
<span style="color:#75715e">#    It isn&#39;t possible to ignore subtag only from specified tree! Ignoring &#34;q/w&#34; will not work!</span>
IGNORE_TAGS <span style="color:#f92672">=</span> [] <span style="color:#75715e"># FIXME</span>
</code></pre></div><p>After running this script you should have <code>index.md</code> file generated in your <code>NOTES_DIR</code>.</p>
<h3 id="sync">Sync</h3>
<p>This is the simplest step, just create <a href="https://www.dropbox.com/">Dropbox</a> account, put your notes there and sync your notes across all devices!</p>
]]></content>
        </item>
        
        <item>
            <title>C&#43;&#43; assembly</title>
            <link>/posts/c&#43;&#43;-assembly/</link>
            <pubDate>Sat, 11 Jan 2020 14:50:06 +0100</pubDate>
            
            <guid>/posts/c&#43;&#43;-assembly/</guid>
            <description>Structures C struct vs C++ class C struct  functions are loosely correlated with paramaters, parameters are usually passed via pointer, it may look like array for struct with 2 identical parameters in struct, for structures created dynamically look for malloc with non-usual size.  C++ class  Find constructor, it have always 1 argument (this pointer -&amp;gt; thiscall), main() function have initialization function __main with ctor initlizers, after creation of class with new operator the class constructor is called (can be empty), Methods are called with thiscall convention.</description>
            <content type="html"><![CDATA[<h2 id="structures">Structures</h2>
<h3 id="c-struct-vs-c-class">C struct vs C++ class</h3>
<h4 id="c-struct">C struct</h4>
<ul>
<li>functions are loosely correlated with paramaters,</li>
<li>parameters are usually passed via pointer,</li>
<li>it may look like array for struct with 2 identical parameters in struct,</li>
<li>for structures created dynamically look for <code>malloc</code> with non-usual size.</li>
</ul>
<h4 id="c-class">C++ class</h4>
<ul>
<li>Find constructor, it have always 1 argument (<code>this</code> pointer -&gt; <code>thiscall</code>),</li>
<li><code>main()</code> function have initialization function <code>__main</code> with ctor initlizers,</li>
<li>after creation of class with <code>new</code> operator the class constructor is called (can be empty),</li>
<li>Methods are called with <code>thiscall</code> convention.</li>
</ul>
<h3 id="inheritance">Inheritance</h3>
<p>Constructors of base class are called 1st in child class, additionally assigment to variables in class definition is put inside constructor:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">void</span> __thiscall <span style="color:#a6e22e">Inherited</span>(Inherited <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>)
{
  Box((Box <span style="color:#f92672">*</span>)<span style="color:#66d9ef">this</span>);
  <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">// this was assigned in class definition, not constructor
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>b <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
  <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>a <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>b;
  <span style="color:#66d9ef">return</span>;
}

</code></pre></div><p>Inherited destructors contains destructors of base class:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">void</span> __thiscall <span style="color:#f92672">~</span>Inherited(Inherited <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>)

{
  <span style="color:#f92672">~</span>Box((Box <span style="color:#f92672">*</span>)<span style="color:#66d9ef">this</span>);
  <span style="color:#66d9ef">return</span>;
}
</code></pre></div><h3 id="virtuals">Virtuals</h3>
<p>Generally we have the same behaviour like in inheritance, but additionally we have also vtables.</p>
<p>The structures of classess contains 1 additional field (at offset 0): <code>vptr</code> to <code>vtable</code> structure containing pointers to all virtual methods in this class:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">vtable_class_A</span> {
  <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">virtual_func_1</span>();
  <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">virtual_func_2</span>();
  <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>};
</code></pre></div><h2 id="references">References</h2>
<ol>
<li><a href="https://oalabs.openanalysis.net/2019/06/03/reverse-engineering-c-with-ida-pro-classes-constructors-and-structs/">OA Labs</a></li>
</ol>
]]></content>
        </item>
        
    </channel>
</rss>
